import{_ as K}from"./Z22KIK-b.js";import{z as B,c as b,E as T,o as u,aa as x,q as w,H as y,r as P,D as f,ad as ee,_ as L,ae as F,Z as S,a0 as A,x as W,s as E,ap as N,$ as X,ab as te,t as I,af as oe,v as O,I as ne,A as se,B as G,a as J,F as R,S as q,a4 as ae,Y as ie,aW as Q,aX as j,aY as re,aZ as ce,a_ as le,C as pe,a$ as H,u as ue,ai as de,b0 as _e,b1 as Y,b2 as ve,j as C,b3 as fe}from"./B8j-voU8.js";import{u as me,a as ge,s as ye,b as $e}from"./D_It6vnr.js";const he=B({__name:"ContentBreadcrumb",props:{context:{}},setup(o){return(n,a)=>{var i;const l=K;return((i=n.context)==null?void 0:i.length)>1?(u(),b(l,{key:0,items:n.context.reduce((p,r,d,e)=>(r.hidden||d===e.length-1||p.push({title:r.title,icon:r.icon,link:r.href}),p),[])},null,8,["items"])):T("",!0)}}}),Ze=Object.assign(he,{__name:"MainContentBreadcrumb"}),we=["src"],be=B({__name:"ContentDecoration",props:{decoration:{}},setup(o){const n=x();return(a,l)=>(u(),w("div",{class:y(a.$style.contentDecoration)},[P("img",{src:f(n)(("contentAsset"in a?a.contentAsset:f(ee))(a.decoration))},null,8,we)],2))}}),ke="_contentDecoration_1catu_1",Ce={contentDecoration:ke},Pe={$style:Ce},We=Object.assign(L(be,[["__cssModules",Pe]]),{__name:"MainContentDecoration"}),Te={key:2},Me=400,Ie=100,Se=B({__name:"ContentPopover",props:{data:{}},setup(o){const n=F("reference"),a=F("popover"),l=F("popover-arrow"),{floatingStyles:i,middlewareData:p}=me(n,a,{whileElementsMounted:ge,middleware:[ye({boundary:(document==null?void 0:document.querySelector("[erudit-main]"))||void 0}),$e({element:l})]}),r=S(!1);let d,e;function m(t){clearTimeout(e),clearTimeout(d),t?r.value=!0:d=setTimeout(()=>{r.value=!0},Me)}function $(){clearTimeout(d),e=setTimeout(()=>{r.value=!1},Ie)}return(t,c)=>{const s=X,_=te,g=oe;return u(),w("div",{ref:"reference",class:y(t.$style.reference),style:A(`--popoverColor: ${t.data.color}`),onMouseenter:c[0]||(c[0]=()=>m()),onMouseleave:$,onClick:c[1]||(c[1]=()=>m(!0))},[f(N)(t.data.icon)?(u(),b(s,{key:0,name:t.data.icon},null,8,["name"])):(u(),b(_,{key:1,name:"popover-icon",svg:t.data.icon},null,8,["svg"])),W(" "+I(t.data.title)+" ",1),E(g,null,{default:O(()=>{var v,h;return[f(r)?(u(),w("div",{key:0,ref:"popover",class:y(t.$style.popover),style:A(f(i))},[P("div",{ref:"popover-arrow",class:y(t.$style.arrow),style:A({position:"absolute",top:((v=f(p).arrow)==null?void 0:v.y)!=null?`${f(p).arrow.y}px`:"",left:((h=f(p).arrow)==null?void 0:h.x)!=null?`${f(p).arrow.x}px`:""})},null,6),P("div",{class:y(t.$style.inner)},[f(N)(t.data.icon)?(u(),b(s,{key:0,class:y(t.$style.floatIcon),name:t.data.icon},null,8,["class","name"])):(u(),b(_,{key:1,class:y(t.$style.floatIcon),name:"popover-icon",svg:t.data.icon},null,8,["class","svg"])),P("div",{class:y(t.$style.title)},I(t.data.title),3),t.data.description?(u(),w("div",Te,I(t.data.description),1)):T("",!0),ne(t.$slots,"default")],2)],6)):T("",!0)]}),_:3})],38)}}}),Be="_reference_ouigi_1",Fe="_popover_ouigi_21",Ae="_arrow_ouigi_31",Ee="_inner_ouigi_40",Oe="_floatIcon_ouigi_50",je="_title_ouigi_56",Le={reference:Be,popover:Fe,arrow:Ae,inner:Ee,floatIcon:Oe,title:je},Ue={$style:Le},Z=Object.assign(L(Se,[["__cssModules",Ue]]),{__name:"MainContentPopover"}),Ve=B({__name:"ContentPopovers",props:{generic:{}},async setup(o){let n,a;const l=o,i=([n,a]=se(()=>G("flag_dev","flag_dev_description","flag_advanced","flag_advanced_description","flag_secondary","flag_secondary_description","popover_dependencies","popover_dependencies_description")),n=await n,a(),n),p={dev:{icon:"construction",color:"var(--warn)",title:i.flag_dev,description:i.flag_dev_description},advanced:{icon:"asterisk",color:"#7c67ac",title:i.flag_advanced,description:i.flag_advanced_description},secondary:{icon:"puzzle",color:"#7faf35",title:i.flag_secondary,description:i.flag_secondary_description}},r={icon:"shuffle",color:"#47baa9",title:i.popover_dependencies,description:i.popover_dependencies_description},d=J(()=>{var e,m,$;return!!((e=l.generic)!=null&&e.flags&&((m=Object.keys(l.generic.flags))!=null&&m.length)||($=l.generic)!=null&&$.dependencies)});return(e,m)=>{var c;const $=X,t=ae;return f(d)?(u(),w("section",{key:0,class:y(e.$style.popovers)},[(u(!0),w(R,null,q(Object.keys(e.generic.flags),s=>(u(),b(Z,{data:p[s]},null,8,["data"]))),256)),(c=e.generic)!=null&&c.dependencies?(u(),b(Z,{key:0,data:r},{default:O(()=>[P("ul",{class:y(e.$style.dependenciesList)},[(u(!0),w(R,null,q(e.generic.dependencies,(s,_)=>(u(),w("li",null,[E($,{name:"arrow-left",wrapper:"span"}),E(t,{to:_},{default:O(()=>[W(I(s),1)]),_:2},1032,["to"])]))),256))],2)]),_:1})):T("",!0)],2)):T("",!0)}}}),ze="_popovers_1wpsg_1",De="_dependenciesList_1wpsg_8",Ne={popovers:ze,dependenciesList:De},Re={$style:Ne},Xe=Object.assign(L(Ve,[["__cssModules",Re]]),{__name:"MainContentPopovers"});function Ge(){var r,d;const o=ie(),n=Q(),a="content-data",l=(d=o.static.data)[a]||(d[a]=(r=o.payload.data)[a]||(r[a]={})),i=S();let p;return j(()=>{p=(async()=>{if(!n.value){i.value=void 0;return}const e=re(n.value.contentId,!1),m=l[e]||(l[e]=await $fetch("/api/content/data",{query:{contentId:e}}));return i.value=m,i})()}),p}function Je(o){const n=Q(),a=ce(),l=le(),i=G("article","summary","practice","site_info_title","seo_article_description","seo_summary_description","seo_practice_description"),p=()=>{setTimeout(()=>{const c=(()=>{var s,_,g;switch((s=n.value)==null?void 0:s.type){case"topic":const v=n.value.topicPart;return((g=(_=C.site)==null?void 0:_.favicon)==null?void 0:g[v])||fe(`favicon/${v}.svg`)}return Y})();l.value=c},500)};let r,d;const e={title:S(),description:S()},m=()=>{r=(async()=>{var g,v,h,k,M,U,V,z;const c=await i;let s="";if(s+=((v=(g=o.value.generic)==null?void 0:g.seo)==null?void 0:v.title)||o.value.generic.title||o.value.generic.contentId.split("/").pop(),n.value.type==="topic"){const D=n.value.topicPart;D!=="article"&&(s+=` | ${c[D]}`)}o.value.type!=="book"&&((h=o.value)!=null&&h.bookTitle)&&!((k=C.content)!=null&&k.bookSiteTitle)&&(s+=` | ${o.value.bookTitle}`);const _=o.value.type!=="book"&&((M=C.content)!=null&&M.bookSiteTitle)&&((U=o.value)!=null&&U.bookTitle)?o.value.bookTitle:((V=C.seo)==null?void 0:V.title)||((z=C.site)==null?void 0:z.title)||c.site_info_title;s+=" - "+_,e.title.value=s})()},$=()=>{d=(async()=>{var _,g,v,h,k;const c=await i,s=((g=(_=o.value.generic)==null?void 0:_.seo)==null?void 0:g.description)||((v=o.value.generic)==null?void 0:v.description);if(s){e.description.value=s.trim().replace(/\n/g," ");return}if(n.value.type==="topic"){const M=c[`seo_${n.value.topicPart}_description`];e.description.value=M(((k=(h=o.value.generic)==null?void 0:h.seo)==null?void 0:k.title)||o.value.generic.title);return}e.description.value=""})()};pe({title:e.title,ogTitle:e.title,description:e.description,ogDescription:e.description});const t=J(()=>{var c,s;return[...H(a,ve),...(c=o.value.generic)!=null&&c.ogImage?H(a,(s=o.value.generic)==null?void 0:s.ogImage):[]]});return ue({meta:t}),j(()=>{m(),$()}),de(()=>{j(()=>{p()})}),_e(()=>{l.value=Y}),Promise.all([r,d])}export{We as C,Je as a,Ze as b,Xe as c,Ge as u};
