import{z as P,b as V,A as J,B as z,n as y,o as i,E as l,q as h,s as C,V as L,C as _,D as k,F as K,c as b,r as M,_ as j,e as T,aX as te,a9 as oe,ae as se,af as F,Z as A,$ as O,x,aq as Y,aa as ne,ag as ae,v as R,K as Z,Q as H,W as re,Y as ce,aY as ee,aZ as E,t as ie,a_ as le,a$ as ue,a as pe,b0 as Q,u as de,a2 as _e,b1 as me,b2 as W,b3 as fe,b4 as ve}from"./BECuGpJR.js";import{u as ye}from"./DqZFkF5A.js";import{_ as ge}from"./CSk0YYnM.js";import{u as $e,a as he,s as ke,b as be}from"./B2FIquoZ.js";import{n as X}from"./DP9JDBlP.js";const we=["href"],Ie=P({__name:"ReferenceSource",props:{source:{}},async setup(s){let t,a;const u=s,r=V(()=>{switch(u.source.type){case"book":return"book";case"site":return"globe";default:return"file-lines"}}),p=ye(),d=([t,a]=J(()=>z("reference_source_featured")),t=await t,a(),t);return(e,o)=>{const f=L;return i(),y("div",{class:l(e.$style.source)},[h("div",{class:l(e.$style.typeIcon)},[C(f,{name:_(r)},null,8,["name"])],2),h("div",{class:l(e.$style.body)},[h("div",{class:l(e.$style.header)},[C(f,{name:_(r),class:l(e.$style.headerTypeIcon)},null,8,["name","class"]),h("a",{href:e.source.link,target:"_blank"},M(_(p)(e.source.title)),9,we),e.source.featured?(i(),b(f,{key:0,name:"star",style:{cursor:"help"},title:_(d).reference_source_featured},null,8,["title"])):k("",!0),e.source.link?(i(),b(f,{key:1,name:"link-external",class:l(e.$style.linkIcon)},null,8,["class"])):k("",!0)],2),e.source.description?(i(),y("div",{key:0,class:l(e.$style.description)},M(_(p)(e.source.description)),3)):k("",!0),e.source.comment?(i(),y("div",{key:1,class:l(e.$style.comment)},M(_(p)(e.source.comment)),3)):k("",!0),K(e.$slots,"after")],2)],2)}}}),Me="_source_1jr0h_1",Te="_typeIcon_1jr0h_6",Ce="_body_1jr0h_17",Pe="_header_1jr0h_22",Be="_headerTypeIcon_1jr0h_44",je="_linkIcon_1jr0h_53",Se="_description_1jr0h_57",Ae="_comment_1jr0h_58",Fe={source:Me,typeIcon:Te,body:Ce,header:Pe,headerTypeIcon:Be,linkIcon:je,description:Se,comment:Ae},Oe={$style:Fe},mt=Object.assign(j(Ie,[["__cssModules",Oe]]),{__name:"MainContentReferenceSource"}),Re=P({__name:"AdsBannerBottom",setup(s){return(t,a)=>{const u=te;return i(),y("section",{class:l(t.$style.darkMagicBottom)},[h("div",{class:l(t.$style.inner)},[C(u,{data:_(T).ads.bottom},null,8,["data"])],2)],2)}}}),Ee="_darkMagicBottom_1tpwu_1",Ve="_inner_1tpwu_4",ze={darkMagicBottom:Ee,inner:Ve},Le={$style:ze},ft=Object.assign(j(Re,[["__cssModules",Le]]),{__name:"AdsBannerBottom"}),Ue=P({__name:"ContentBreadcrumb",props:{context:{}},setup(s){return(t,a)=>{var r;const u=ge;return((r=t.context)==null?void 0:r.length)>1?(i(),b(u,{key:0,items:t.context.reduce((p,d,e,o)=>(d.hidden||e===o.length-1||p.push({title:d.title,icon:d.icon,link:d.href}),p),[])},null,8,["items"])):k("",!0)}}}),vt=Object.assign(Ue,{__name:"MainContentBreadcrumb"}),De=["src"],Ne=P({__name:"ContentDecoration",props:{decoration:{}},setup(s){const t=oe();return(a,u)=>(i(),y("div",{class:l(a.$style.contentDecoration)},[h("img",{src:_(t)(("contentAsset"in a?a.contentAsset:_(se))(a.decoration))},null,8,De)],2))}}),qe="_contentDecoration_1catu_1",Ye={contentDecoration:qe},Ze={$style:Ye},yt=Object.assign(j(Ne,[["__cssModules",Ze]]),{__name:"MainContentDecoration"}),He={key:2},Qe=400,We=100,Xe=P({__name:"ContentPopover",props:{data:{}},setup(s){const t=F("reference"),a=F("popover"),u=F("popover-arrow"),{floatingStyles:r,middlewareData:p}=$e(t,a,{whileElementsMounted:he,middleware:[ke({boundary:(document==null?void 0:document.querySelector("[erudit-main]"))||void 0}),be({element:u})]}),d=A(!1);let e,o;function f(n){clearTimeout(o),clearTimeout(e),n?d.value=!0:e=setTimeout(()=>{d.value=!0},Qe)}function w(){clearTimeout(e),o=setTimeout(()=>{d.value=!1},We)}return(n,m)=>{const c=L,v=ne,$=ae;return i(),y("div",{ref:"reference",class:l(n.$style.reference),style:O(`--popoverColor: ${n.data.color}`),onMouseenter:m[0]||(m[0]=()=>f()),onMouseleave:w,onClick:m[1]||(m[1]=()=>f(!0))},[_(Y)(n.data.icon)?(i(),b(c,{key:0,name:n.data.icon},null,8,["name"])):(i(),b(v,{key:1,name:"popover-icon",svg:n.data.icon},null,8,["svg"])),x(" "+M(n.data.title)+" ",1),C($,null,{default:R(()=>{var g,I;return[_(d)?(i(),y("div",{key:0,ref:"popover",class:l(n.$style.popover),style:O(_(r))},[h("div",{ref:"popover-arrow",class:l(n.$style.arrow),style:O({position:"absolute",top:((g=_(p).arrow)==null?void 0:g.y)!=null?`${_(p).arrow.y}px`:"",left:((I=_(p).arrow)==null?void 0:I.x)!=null?`${_(p).arrow.x}px`:""})},null,6),h("div",{class:l(n.$style.inner)},[_(Y)(n.data.icon)?(i(),b(c,{key:0,class:l(n.$style.floatIcon),name:n.data.icon},null,8,["class","name"])):(i(),b(v,{key:1,class:l(n.$style.floatIcon),name:"popover-icon",svg:n.data.icon},null,8,["class","svg"])),h("div",{class:l(n.$style.title)},M(n.data.title),3),n.data.description?(i(),y("div",He,M(n.data.description),1)):k("",!0),K(n.$slots,"default")],2)],6)):k("",!0)]}),_:3})],38)}}}),Ge="_reference_ouigi_1",Je="_popover_ouigi_21",Ke="_arrow_ouigi_31",xe="_inner_ouigi_40",et="_floatIcon_ouigi_50",tt="_title_ouigi_56",ot={reference:Ge,popover:Je,arrow:Ke,inner:xe,floatIcon:et,title:tt},st={$style:ot},G=Object.assign(j(Xe,[["__cssModules",st]]),{__name:"MainContentPopover"}),nt=P({__name:"ContentPopovers",props:{generic:{}},async setup(s){let t,a;const u=s,r=([t,a]=J(()=>z("flag_dev","flag_dev_description","flag_advanced","flag_advanced_description","flag_secondary","flag_secondary_description","popover_dependencies","popover_dependencies_description")),t=await t,a(),t),p={dev:{icon:"construction",color:"var(--warn)",title:r.flag_dev,description:r.flag_dev_description},advanced:{icon:"asterisk",color:"#7c67ac",title:r.flag_advanced,description:r.flag_advanced_description},secondary:{icon:"puzzle",color:"#7faf35",title:r.flag_secondary,description:r.flag_secondary_description}},d={icon:"shuffle",color:"#47baa9",title:r.popover_dependencies,description:r.popover_dependencies_description},e=V(()=>{var o,f,w;return!!((o=u.generic)!=null&&o.flags&&((f=Object.keys(u.generic.flags))!=null&&f.length)||(w=u.generic)!=null&&w.dependencies)});return(o,f)=>{var m;const w=L,n=re;return _(e)?(i(),y("section",{key:0,class:l(o.$style.popovers)},[(i(!0),y(Z,null,H(Object.keys(o.generic.flags),c=>(i(),b(G,{data:p[c]},null,8,["data"]))),256)),(m=o.generic)!=null&&m.dependencies?(i(),b(G,{key:0,data:d},{default:R(()=>[h("ul",{class:l(o.$style.dependenciesList)},[(i(!0),y(Z,null,H(o.generic.dependencies,(c,v)=>(i(),y("li",null,[C(w,{name:"arrow-left",wrapper:"span"}),C(n,{to:v},{default:R(()=>[x(M(c),1)]),_:2},1032,["to"])]))),256))],2)]),_:1})):k("",!0)],2)):k("",!0)}}}),at="_popovers_iys1y_1",rt="_dependenciesList_iys1y_14",ct={popovers:at,dependenciesList:rt},it={$style:ct},gt=Object.assign(j(nt,[["__cssModules",it]]),{__name:"MainContentPopovers"});function $t(){var d,e;const s=ce(),t=ee(),a="content-data",u=(e=s.static.data)[a]||(e[a]=(d=s.payload.data)[a]||(d[a]={})),r=A();let p;return E(()=>{p=(async()=>{if(!t.value){r.value=void 0;return}const o=ie(t.value.contentId,!1),f=u[o]||(u[o]=await $fetch("/api/content/data",{query:{contentId:o}}));return r.value=f,r})()}),p}function ht(s){const t=ee(),a=le(),u=ue(),r=z("article","summary","practice","site_info_title","seo_article_description","seo_summary_description","seo_practice_description"),p=()=>{setTimeout(()=>{const m=(()=>{var c,v,$;switch((c=t.value)==null?void 0:c.type){case"topic":const g=t.value.topicPart;return(($=(v=T.site)==null?void 0:v.favicon)==null?void 0:$[g])||ve(`favicon/${g}.svg`)}return W})();u.value=m},500)};let d,e;const o={title:A(),description:A()},f=()=>{d=(async()=>{var $,g,I,B,S,U,D,N;const m=await r;let c="";if(c+=((g=($=s.value.generic)==null?void 0:$.seo)==null?void 0:g.title)||s.value.generic.title||s.value.generic.contentId.split("/").pop(),t.value.type==="topic"){const q=t.value.topicPart;q!=="article"&&(c+=` | ${m[q]}`)}s.value.type!=="book"&&((I=s.value)!=null&&I.bookTitle)&&!((B=T.content)!=null&&B.bookSiteTitle)&&(c+=` | ${s.value.bookTitle}`);const v=s.value.type!=="book"&&((S=T.content)!=null&&S.bookSiteTitle)&&((U=s.value)!=null&&U.bookTitle)?s.value.bookTitle:((D=T.seo)==null?void 0:D.title)||((N=T.site)==null?void 0:N.title)||m.site_info_title;c+=" - "+v,o.title.value=c})()},w=()=>{e=(async()=>{var v,$,g,I,B;const m=await r,c=(($=(v=s.value.generic)==null?void 0:v.seo)==null?void 0:$.description)||((g=s.value.generic)==null?void 0:g.description);if(c){o.description.value=X(c);return}if(t.value.type==="topic"){const S=m[`seo_${t.value.topicPart}_description`];o.description.value=X(S(((B=(I=s.value.generic)==null?void 0:I.seo)==null?void 0:B.title)||s.value.generic.title));return}o.description.value=""})()};pe({title:o.title,ogTitle:o.title,description:o.description,ogDescription:o.description});const n=V(()=>{var m,c;return[...Q(a,fe),...(m=s.value.generic)!=null&&m.ogImage?Q(a,(c=s.value.generic)==null?void 0:c.ogImage):[]]});return de({meta:n}),E(()=>{f(),w()}),_e(()=>{E(()=>{p()})}),me(()=>{u.value=W}),Promise.all([d,e])}export{yt as C,mt as R,ft as _,ht as a,vt as b,gt as c,$t as u};
