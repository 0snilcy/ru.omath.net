import{_ as K}from"./BX2DEax_.js";import{A as B,c as b,F as T,o as p,ab as x,q as w,I as y,r as P,E as f,ae as ee,_ as U,af as F,$ as S,a1 as j,y as J,v as A,aq as R,a0 as X,ac as te,s as I,ag as oe,x as E,J as ne,B as se,C as Y,a as Q,G as q,U as z,a5 as ae,Z as ie,aX as W,aY as O,t as re,aZ as ce,a_ as le,D as ue,a$ as Z,u as pe,aj as de,b0 as _e,b1 as G,b2 as ve,j as C,b3 as fe}from"./Bmaw4-yZ.js";import{u as me,a as ge,s as ye,b as $e}from"./y7yBrWNN.js";const he=B({__name:"ContentBreadcrumb",props:{context:{}},setup(o){return(n,a)=>{var i;const l=K;return((i=n.context)==null?void 0:i.length)>1?(p(),b(l,{key:0,items:n.context.reduce((u,r,d,e)=>(r.hidden||d===e.length-1||u.push({title:r.title,icon:r.icon,link:r.href}),u),[])},null,8,["items"])):T("",!0)}}}),He=Object.assign(he,{__name:"MainContentBreadcrumb"}),we=["src"],be=B({__name:"ContentDecoration",props:{decoration:{}},setup(o){const n=x();return(a,l)=>(p(),w("div",{class:y(a.$style.contentDecoration)},[P("img",{src:f(n)(("contentAsset"in a?a.contentAsset:f(ee))(a.decoration))},null,8,we)],2))}}),ke="_contentDecoration_1catu_1",Ce={contentDecoration:ke},Pe={$style:Ce},Je=Object.assign(U(be,[["__cssModules",Pe]]),{__name:"MainContentDecoration"}),Te={key:2},Me=400,Ie=100,Se=B({__name:"ContentPopover",props:{data:{}},setup(o){const n=F("reference"),a=F("popover"),l=F("popover-arrow"),{floatingStyles:i,middlewareData:u}=me(n,a,{whileElementsMounted:ge,middleware:[ye({boundary:(document==null?void 0:document.querySelector("[erudit-main]"))||void 0}),$e({element:l})]}),r=S(!1);let d,e;function m(t){clearTimeout(e),clearTimeout(d),t?r.value=!0:d=setTimeout(()=>{r.value=!0},Me)}function $(){clearTimeout(d),e=setTimeout(()=>{r.value=!1},Ie)}return(t,c)=>{const s=X,_=te,g=oe;return p(),w("div",{ref:"reference",class:y(t.$style.reference),style:j(`--popoverColor: ${t.data.color}`),onMouseenter:c[0]||(c[0]=()=>m()),onMouseleave:$,onClick:c[1]||(c[1]=()=>m(!0))},[f(R)(t.data.icon)?(p(),b(s,{key:0,name:t.data.icon},null,8,["name"])):(p(),b(_,{key:1,name:"popover-icon",svg:t.data.icon},null,8,["svg"])),J(" "+I(t.data.title)+" ",1),A(g,null,{default:E(()=>{var v,h;return[f(r)?(p(),w("div",{key:0,ref:"popover",class:y(t.$style.popover),style:j(f(i))},[P("div",{ref:"popover-arrow",class:y(t.$style.arrow),style:j({position:"absolute",top:((v=f(u).arrow)==null?void 0:v.y)!=null?`${f(u).arrow.y}px`:"",left:((h=f(u).arrow)==null?void 0:h.x)!=null?`${f(u).arrow.x}px`:""})},null,6),P("div",{class:y(t.$style.inner)},[f(R)(t.data.icon)?(p(),b(s,{key:0,class:y(t.$style.floatIcon),name:t.data.icon},null,8,["class","name"])):(p(),b(_,{key:1,class:y(t.$style.floatIcon),name:"popover-icon",svg:t.data.icon},null,8,["class","svg"])),P("div",{class:y(t.$style.title)},I(t.data.title),3),t.data.description?(p(),w("div",Te,I(t.data.description),1)):T("",!0),ne(t.$slots,"default")],2)],6)):T("",!0)]}),_:3})],38)}}}),Be="_reference_ouigi_1",Fe="_popover_ouigi_21",je="_arrow_ouigi_31",Ae="_inner_ouigi_40",Ee="_floatIcon_ouigi_50",Oe="_title_ouigi_56",Ue={reference:Be,popover:Fe,arrow:je,inner:Ae,floatIcon:Ee,title:Oe},Le={$style:Ue},H=Object.assign(U(Se,[["__cssModules",Le]]),{__name:"MainContentPopover"}),Ve=B({__name:"ContentPopovers",props:{generic:{}},async setup(o){let n,a;const l=o,i=([n,a]=se(()=>Y("flag_dev","flag_dev_description","flag_advanced","flag_advanced_description","flag_secondary","flag_secondary_description","popover_dependencies","popover_dependencies_description")),n=await n,a(),n),u={dev:{icon:"construction",color:"var(--warn)",title:i.flag_dev,description:i.flag_dev_description},advanced:{icon:"asterisk",color:"#7c67ac",title:i.flag_advanced,description:i.flag_advanced_description},secondary:{icon:"puzzle",color:"#7faf35",title:i.flag_secondary,description:i.flag_secondary_description}},r={icon:"shuffle",color:"#47baa9",title:i.popover_dependencies,description:i.popover_dependencies_description},d=Q(()=>{var e,m,$;return!!((e=l.generic)!=null&&e.flags&&((m=Object.keys(l.generic.flags))!=null&&m.length)||($=l.generic)!=null&&$.dependencies)});return(e,m)=>{var c;const $=X,t=ae;return f(d)?(p(),w("section",{key:0,class:y(e.$style.popovers)},[(p(!0),w(q,null,z(Object.keys(e.generic.flags),s=>(p(),b(H,{data:u[s]},null,8,["data"]))),256)),(c=e.generic)!=null&&c.dependencies?(p(),b(H,{key:0,data:r},{default:E(()=>[P("ul",{class:y(e.$style.dependenciesList)},[(p(!0),w(q,null,z(e.generic.dependencies,(s,_)=>(p(),w("li",null,[A($,{name:"arrow-left",wrapper:"span"}),A(t,{to:_},{default:E(()=>[J(I(s),1)]),_:2},1032,["to"])]))),256))],2)]),_:1})):T("",!0)],2)):T("",!0)}}}),De="_popovers_1wpsg_1",Ne="_dependenciesList_1wpsg_8",Re={popovers:De,dependenciesList:Ne},qe={$style:Re},Xe=Object.assign(U(Ve,[["__cssModules",qe]]),{__name:"MainContentPopovers"});function Ye(){var r,d;const o=ie(),n=W(),a="content-data",l=(d=o.static.data)[a]||(d[a]=(r=o.payload.data)[a]||(r[a]={})),i=S();let u;return O(()=>{u=(async()=>{if(!n.value){i.value=void 0;return}const e=re(n.value.contentId,!1),m=l[e]||(l[e]=await $fetch("/api/content/data",{query:{contentId:e}}));return i.value=m,i})()}),u}function Qe(o){const n=W(),a=ce(),l=le(),i=Y("article","summary","practice","site_info_title","seo_article_description","seo_summary_description","seo_practice_description"),u=()=>{setTimeout(()=>{const c=(()=>{var s,_,g;switch((s=n.value)==null?void 0:s.type){case"topic":const v=n.value.topicPart;return((g=(_=C.site)==null?void 0:_.favicon)==null?void 0:g[v])||fe(`favicon/${v}.svg`)}return G})();l.value=c},500)};let r,d;const e={title:S(),description:S()},m=()=>{r=(async()=>{var g,v,h,k,M,L,V,D;const c=await i;let s="";if(s+=((v=(g=o.value.generic)==null?void 0:g.seo)==null?void 0:v.title)||o.value.generic.title||o.value.generic.contentId.split("/").pop(),n.value.type==="topic"){const N=n.value.topicPart;N!=="article"&&(s+=` | ${c[N]}`)}o.value.type!=="book"&&((h=o.value)!=null&&h.bookTitle)&&!((k=C.content)!=null&&k.bookSiteTitle)&&(s+=` | ${o.value.bookTitle}`);const _=o.value.type!=="book"&&((M=C.content)!=null&&M.bookSiteTitle)&&((L=o.value)!=null&&L.bookTitle)?o.value.bookTitle:((V=C.seo)==null?void 0:V.title)||((D=C.site)==null?void 0:D.title)||c.site_info_title;s+=" - "+_,e.title.value=s})()},$=()=>{d=(async()=>{var _,g,v,h,k;const c=await i,s=((g=(_=o.value.generic)==null?void 0:_.seo)==null?void 0:g.description)||((v=o.value.generic)==null?void 0:v.description);if(s){e.description.value=s.trim().replace(/\n/g," ");return}if(n.value.type==="topic"){const M=c[`seo_${n.value.topicPart}_description`];e.description.value=M(((k=(h=o.value.generic)==null?void 0:h.seo)==null?void 0:k.title)||o.value.generic.title);return}e.description.value=""})()};ue({title:e.title,ogTitle:e.title,description:e.description,ogDescription:e.description});const t=Q(()=>{var c,s;return[...Z(a,ve),...(c=o.value.generic)!=null&&c.ogImage?Z(a,(s=o.value.generic)==null?void 0:s.ogImage):[]]});return pe({meta:t}),O(()=>{m(),$()}),de(()=>{O(()=>{u()})}),_e(()=>{l.value=G}),Promise.all([r,d])}export{Je as C,Qe as a,He as b,Xe as c,Ye as u};
