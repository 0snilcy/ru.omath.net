import{x as k,c as m,o as c,G as d,l as T,B as _,a0 as ee,a2 as te,_ as I,F as U,O as E,n as C,q as B,s as V,$ as j,t as M,ag as ne,a as w,aD as N,Z as W,y as X,a3 as L,r as F,a6 as A,a4 as se,C as O,E as oe,z as Y,b as K,v as ae,an as ie,aE as x,ao as R,aF as re,aG as ce,aH as le,A as pe,aI as J,u as ue,a8 as de,aJ as _e,aK as Z,aL as me,j as D,aC as ve}from"./DmPrUm6p.js";import{u as fe}from"./BME4XLkG.js";import{u as ge,a as ye,s as $e,b as be}from"./BpEflsFv.js";const he=["src"],we=k({__name:"ContentDecoration",props:{decoration:{}},setup(t){const e=ee();return(o,a)=>(c(),m("div",{class:d(o.$style.contentDecoration)},[T("img",{src:_(e)(("contentAsset"in o?o.contentAsset:_(te))(o.decoration))},null,8,he)],2))}}),Me="_contentDecoration_1catu_1",Te={contentDecoration:Me},Ce={$style:Te},it=Object.assign(I(we,[["__cssModules",Ce]]),{__name:"MainUtilsContentDecoration"}),ke=k({__name:"Breadcrumb",props:{context:{}},setup(t){const e=ne({prefetch:!1});function o(a){return a}return(a,i)=>{const u=j;return c(),m("section",{class:d(a.$style.breadcrumb)},[(c(!0),m(U,null,E(a.context.slice(0,-1).filter(l=>!l.hidden),l=>(c(),m(U,null,[C(_(e),{to:l.href,class:d(a.$style.breadcrumbItem)},{default:B(()=>[C(u,{name:l.icon,wrapper:"span"},null,8,["name"]),V(" "+M(l.title),1)]),_:2},1032,["to","class"]),C(u,{class:d(a.$style.sep),name:"angle-right"},null,8,["class"])],64))),256))],2)}}}),Ie="_breadcrumb_1e1w1_1",Pe="_breadcrumbItem_1e1w1_19",De="_sep_1e1w1_34",Se={breadcrumb:Ie,breadcrumbItem:Pe,sep:De},Ue={$style:Se},rt=Object.assign(I(ke,[["__cssModules",Ue]]),{__name:"MainUtilsBreadcrumb"}),Be=k({__name:"ContentTitle",props:{icon:{},title:{},hint:{}},setup(t){return(e,o)=>{const a=j,i=W;return c(),m("section",{class:d(e.$style.contentTitle)},[_(N)(e.icon)?(c(),w(a,{key:0,name:e.icon,title:e.hint},null,8,["name","title"])):(c(),w(i,{key:1,name:"content-title-icon",svg:e.icon,title:e.hint},null,8,["svg","title"])),T("h1",null,M(e.title),1)],2)}}}),Fe="_contentTitle_p3ocd_1",Oe={contentTitle:Fe},je={$style:Oe},ct=Object.assign(I(Be,[["__cssModules",je]]),{__name:"MainUtilsContentTitle"}),Le=k({__name:"ContentDescription",props:{description:{}},async setup(t){let e,o;const a=([e,o]=X(()=>fe()),e=await e,o(),e);return(i,u)=>(c(),m("section",{class:d(i.$style.contentDescription)},M(_(a)(i.description)),3))}}),Ae="_contentDescription_x6dlr_1",Ee={contentDescription:Ae},Ne={$style:Ee},lt=Object.assign(I(Le,[["__cssModules",Ne]]),{__name:"MainUtilsContentDescription"}),Re={key:2},Ve=400,ze=100,qe=k({__name:"ContentPopover",props:{data:{}},setup(t){const e=L("reference"),o=L("popover"),a=L("popover-arrow"),{floatingStyles:i,middlewareData:u}=ge(e,o,{whileElementsMounted:ye,middleware:[$e({boundary:(document==null?void 0:document.querySelector("[erudit-main]"))||void 0}),be({element:a})]}),l=F(!1);let f,n;function y(s){clearTimeout(n),clearTimeout(f),s?l.value=!0:f=setTimeout(()=>{l.value=!0},Ve)}function b(){clearTimeout(f),n=setTimeout(()=>{l.value=!1},ze)}return(s,p)=>{const r=j,v=W,$=se;return c(),m("div",{ref:"reference",class:d(s.$style.reference),style:A(`--popoverColor: ${s.data.color}`),onMouseenter:p[0]||(p[0]=()=>y()),onMouseleave:b,onClick:p[1]||(p[1]=()=>y(!0))},[_(N)(s.data.icon)?(c(),w(r,{key:0,name:s.data.icon},null,8,["name"])):(c(),w(v,{key:1,name:"popover-icon",svg:s.data.icon},null,8,["svg"])),V(" "+M(s.data.title)+" ",1),C($,null,{default:B(()=>{var g,h;return[_(l)?(c(),m("div",{key:0,ref:"popover",class:d(s.$style.popover),style:A(_(i))},[T("div",{ref:"popover-arrow",class:d(s.$style.arrow),style:A({position:"absolute",top:((g=_(u).arrow)==null?void 0:g.y)!=null?`${_(u).arrow.y}px`:"",left:((h=_(u).arrow)==null?void 0:h.x)!=null?`${_(u).arrow.x}px`:""})},null,6),T("div",{class:d(s.$style.inner)},[_(N)(s.data.icon)?(c(),w(r,{key:0,class:d(s.$style.floatIcon),name:s.data.icon},null,8,["class","name"])):(c(),w(v,{key:1,class:d(s.$style.floatIcon),name:"popover-icon",svg:s.data.icon},null,8,["class","svg"])),T("div",{class:d(s.$style.title)},M(s.data.title),3),s.data.description?(c(),m("div",Re,M(s.data.description),1)):O("",!0),oe(s.$slots,"default")],2)],6)):O("",!0)]}),_:3})],38)}}}),Ge="_reference_ouigi_1",He="_popover_ouigi_21",Je="_arrow_ouigi_31",Ze="_inner_ouigi_40",Qe="_floatIcon_ouigi_50",We="_title_ouigi_56",Xe={reference:Ge,popover:He,arrow:Je,inner:Ze,floatIcon:Qe,title:We},Ye={$style:Xe},Q=Object.assign(I(qe,[["__cssModules",Ye]]),{__name:"MainUtilsContentPopover"}),Ke=k({__name:"ContentPopovers",props:{generic:{}},async setup(t){let e,o;const a=t,i=([e,o]=X(()=>Y("flag_dev","flag_dev_description","flag_advanced","flag_advanced_description","flag_secondary","flag_secondary_description","popover_dependencies","popover_dependencies_description")),e=await e,o(),e),u={dev:{icon:"construction",color:"var(--warn)",title:i.flag_dev,description:i.flag_dev_description},advanced:{icon:"asterisk",color:"#7c67ac",title:i.flag_advanced,description:i.flag_advanced_description},secondary:{icon:"puzzle",color:"#7faf35",title:i.flag_secondary,description:i.flag_secondary_description}},l={icon:"shuffle",color:"#47baa9",title:i.popover_dependencies,description:i.popover_dependencies_description},f=K(()=>{var n,y,b;return!!((n=a.generic)!=null&&n.flags&&((y=Object.keys(a.generic.flags))!=null&&y.length)||(b=a.generic)!=null&&b.dependencies)});return(n,y)=>{var p;const b=j,s=ae;return _(f)?(c(),m("section",{key:0,class:d(n.$style.popovers)},[(c(!0),m(U,null,E(Object.keys(n.generic.flags),r=>(c(),w(Q,{data:u[r]},null,8,["data"]))),256)),(p=n.generic)!=null&&p.dependencies?(c(),w(Q,{key:0,data:l},{default:B(()=>[T("ul",{class:d(n.$style.dependenciesList)},[(c(!0),m(U,null,E(n.generic.dependencies,(r,v)=>(c(),m("li",null,[C(b,{name:"arrow-left",wrapper:"span"}),C(s,{prefetch:!1,to:v},{default:B(()=>[V(M(r),1)]),_:2},1032,["to"])]))),256))],2)]),_:1})):O("",!0)],2)):O("",!0)}}}),xe="_popovers_1wpsg_1",et="_dependenciesList_1wpsg_8",tt={popovers:xe,dependenciesList:et},nt={$style:tt},pt=Object.assign(I(Ke,[["__cssModules",nt]]),{__name:"MainUtilsContentPopovers"});function ut(){var l,f;const t=ie(),e=x(),o="content-data",a=(f=t.static.data)[o]||(f[o]=(l=t.payload.data)[o]||(l[o]={})),i=F();let u;return R(()=>{u=(async()=>{if(!e.value){i.value=void 0;return}const n=re(e.value.contentId),y=a[n]||(a[n]=await $fetch("/api/content/data",{query:{contentId:n}}));return i.value=y,i})()}),u}function dt(t){const e=x(),o=ce(),a=le(),i=Y("article","summary","practice","site_info_title","seo_article_description","seo_summary_description","seo_practice_description"),u=()=>{setTimeout(()=>{const p=(()=>{var r,v,$;switch((r=e.value)==null?void 0:r.type){case"topic":const g=e.value.topicPart;return(($=(v=D.site)==null?void 0:v.favicon)==null?void 0:$[g])||ve(`favicon/${g}.svg`)}return Z})();a.value=p},500)};let l,f;const n={title:F(),description:F()},y=()=>{l=(async()=>{var $,g,h,P,S,z,q,G;const p=await i;let r="";if(r+=((g=($=t.value.generic)==null?void 0:$.seo)==null?void 0:g.title)||t.value.generic.title||t.value.generic.contentId.split("/").pop(),e.value.type==="topic"){const H=e.value.topicPart;H!=="article"&&(r+=` | ${p[H]}`)}t.value.type!=="book"&&((h=t.value)!=null&&h.bookTitle)&&!((P=D.content)!=null&&P.bookSiteTitle)&&(r+=` | ${t.value.bookTitle}`);const v=t.value.type!=="book"&&((S=D.content)!=null&&S.bookSiteTitle)&&((z=t.value)!=null&&z.bookTitle)?t.value.bookTitle:((q=D.seo)==null?void 0:q.title)||((G=D.site)==null?void 0:G.title)||p.site_info_title;r+=" - "+v,n.title.value=r})()},b=()=>{f=(async()=>{var v,$,g,h,P;const p=await i,r=(($=(v=t.value.generic)==null?void 0:v.seo)==null?void 0:$.description)||((g=t.value.generic)==null?void 0:g.description);if(r){n.description.value=r.trim().replace(/\n/g," ");return}if(e.value.type==="topic"){const S=p[`seo_${e.value.topicPart}_description`];n.description.value=S(((P=(h=t.value.generic)==null?void 0:h.seo)==null?void 0:P.title)||t.value.generic.title);return}n.description.value=""})()};pe({title:n.title,ogTitle:n.title,description:n.description,ogDescription:n.description});const s=K(()=>{var p,r;return[...J(o,me),...(p=t.value.generic)!=null&&p.ogImage?J(o,(r=t.value.generic)==null?void 0:r.ogImage):[]]});return ue({meta:s}),R(()=>{y(),b()}),de(()=>{R(()=>{u()})}),_e(()=>{a.value=Z}),Promise.all([l,f])}export{rt as B,it as C,dt as a,ct as b,lt as c,pt as d,ut as u};
